<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <!-- é—œéµï¼šRWD èˆ‡æ‰‹æ©Ÿé©é…è¨­å®š -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="format-detection" content="telephone=no">
    <meta name="theme-color" content="#240046">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <title>ç´«å¾®åŸºå› å¡”ç¾…è§£ç¢¼</title>
    
    <style>
        /* --- å…¨åŸŸè®Šæ•¸èˆ‡é‡ç½® --- */
        :root {
            --primary: #7b2cbf;
            --bg: #10002b;
            --card: #240046;
            --accent: #ff9e00;
            --text: #ffffff;
            --timeline-line: rgba(255, 158, 0, 0.3);
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: var(--bg); color: var(--text); min-height: 100vh;
            background-image: linear-gradient(160deg, #10002b 0%, #3c096c 100%);
            padding-bottom: 50px; /* æ‰‹æ©Ÿåº•éƒ¨ç•™ç™½ */
        }
        .container { width: 100%; max-width: 480px; margin: 0 auto; padding: 20px; }

        /* --- Header --- */
        .header { text-align: center; margin: 15px 0 25px; }
        .logo { font-size: 3.5rem; animation: float 3s ease-in-out infinite; display: inline-block; text-shadow: 0 0 20px rgba(123, 44, 191, 0.6); }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }
        .title { font-size: 1.8rem; margin: 5px 0; color: #e0aaff; letter-spacing: 1px; font-weight: 800; }
        .subtitle { font-size: 0.9rem; color: #9d4edd; opacity: 0.9; }

        /* --- è¼¸å…¥è¡¨å–® --- */
        .input-card {
            background: rgba(36, 0, 70, 0.6); backdrop-filter: blur(10px);
            padding: 25px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3); animation: fadeIn 0.8s;
        }
        .form-group { margin-bottom: 20px; }
        .label { display: block; margin-bottom: 8px; color: #c77dff; font-size: 0.95rem; }
        input, select {
            width: 100%; padding: 14px; border-radius: 12px; border: 1px solid #5a189a;
            background: rgba(0,0,0,0.3); color: #fff; font-size: 16px; outline: none;
            appearance: none; /* ç§»é™¤åŸç”Ÿæ¨£å¼ */
        }
        .btn-main {
            width: 100%; padding: 16px; border-radius: 50px; border: none;
            background: linear-gradient(90deg, #7b2cbf, #ff9e00); color: white;
            font-size: 1.2rem; font-weight: bold; margin-top: 10px; cursor: pointer;
            box-shadow: 0 4px 15px rgba(255, 158, 0, 0.4); transition: transform 0.2s;
        }
        .btn-main:active { transform: scale(0.98); }

        /* --- çµæœå€ --- */
        #result-section { display: none; animation: slideUp 0.5s ease-out; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

        /* èº«ä»½å¡ */
        .identity-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.02));
            border: 1px solid rgba(255,255,255,0.2); border-radius: 20px; padding: 20px;
            display: flex; align-items: center; gap: 15px; margin-bottom: 20px; position: relative; overflow: hidden;
        }
        .star-icon { font-size: 2.5rem; background: rgba(0,0,0,0.2); padding: 10px; border-radius: 50%; }
        .id-info h2 { margin: 0; font-size: 1.6rem; color: var(--accent); }
        .id-info p { margin: 5px 0 0; opacity: 0.8; font-size: 0.9rem; }
        .blood-tag { position: absolute; top: 20px; right: 20px; background: #d00000; font-size: 0.85rem; padding: 4px 10px; border-radius: 6px; font-weight: bold; }

        /* Tabs */
        .main-tabs { display: flex; background: #1a0b2e; border-radius: 15px; padding: 5px; margin-bottom: 20px; border: 1px solid #3c096c;}
        .tab-btn { flex: 1; text-align: center; padding: 12px; border-radius: 12px; color: #aaa; cursor: pointer; transition: 0.3s; font-size: 1rem; font-weight: 500;}
        .tab-btn.active { background: var(--card); color: var(--accent); font-weight: bold; box-shadow: 0 2px 10px rgba(0,0,0,0.3); border: 1px solid var(--accent); }

        .content-view { display: none; }
        .content-view.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* === VIEW 1: ä»Šæ—¥é‹å‹¢ === */
        .daily-box {
            background: var(--card); border-radius: 20px; padding: 20px; margin-bottom: 25px;
            border: 1px solid #5a189a; box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }
        .date-badge { background: rgba(255,255,255,0.1); padding: 4px 12px; border-radius: 20px; font-size: 0.9rem; display: inline-block; margin-bottom: 15px; color: #e0aaff; letter-spacing: 1px;}
        .lucky-row { display: flex; justify-content: space-between; margin-bottom: 20px; text-align: center; background: rgba(0,0,0,0.2); padding: 15px; border-radius: 15px;}
        .lucky-item { flex: 1; }
        .lucky-val { font-size: 1.1rem; font-weight: bold; color: var(--accent); display: block; margin-bottom: 5px;}
        .lucky-label { font-size: 0.8rem; opacity: 0.7; }
        .yi-ji-row { display: flex; gap: 10px; margin-bottom: 20px; }
        .yj-card { flex: 1; padding: 12px; border-radius: 12px; font-size: 0.95rem; line-height: 1.4; }
        .yi { background: rgba(6, 214, 160, 0.1); border: 1px solid #06d6a0; color: #a7f3d0; }
        .ji { background: rgba(239, 71, 111, 0.1); border: 1px solid #ef476f; color: #fecaca; }
        .daily-msg { line-height: 1.6; font-size: 1rem; color: #eee; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 15px; text-align: justify;}

        /* === å¡”ç¾…å€ === */
        .tarot-section {
            background: linear-gradient(180deg, #2d0036 0%, #19002e 100%);
            border-radius: 20px; padding: 25px 20px; text-align: center;
            border: 2px solid #ffd700; position: relative; overflow: hidden; box-shadow: 0 0 25px rgba(255, 215, 0, 0.15);
        }
        .tarot-title { color: #ffd700; font-size: 1.3rem; margin-bottom: 15px; font-weight: bold; letter-spacing: 2px; text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);}
        .card-scene { width: 140px; height: 220px; perspective: 1000px; margin: 0 auto 20px; cursor: pointer; }
        .card-obj { width: 100%; height: 100%; position: relative; transform-style: preserve-3d; transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .card-obj.is-flipped { transform: rotateY(180deg); }
        .card-face {
            position: absolute; width: 100%; height: 100%; backface-visibility: hidden;
            border-radius: 12px; display: flex; flex-direction: column; align-items: center; justify-content: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .card-back {
            background: radial-gradient(circle, #4a148c 0%, #1a0b2e 100%); border: 3px solid #ffd700;
            background-image: repeating-linear-gradient(45deg, rgba(255,215,0,0.05) 0px, rgba(255,215,0,0.05) 2px, transparent 2px, transparent 10px);
        }
        .card-back::after { content: "â˜…"; font-size: 4rem; color: #ffd700; opacity: 0.3; }
        .card-front { background: #fff; color: #333; transform: rotateY(180deg); border: 4px solid #ffd700; }
        .tarot-img { font-size: 5rem; margin-bottom: 10px; }
        .tarot-name { font-size: 1.4rem; font-weight: bold; color: #240046; margin-bottom: 5px; }
        .tarot-key { font-size: 0.9rem; color: #555; background: #eee; padding: 4px 12px; border-radius: 15px; }
        .tarot-desc-box { background: rgba(255,255,255,0.1); padding: 15px; border-radius: 12px; text-align: left; display: none; animation: fadeIn 1s; margin-top: 15px;}
        .tarot-btn { background: transparent; border: 1px solid #ffd700; color: #ffd700; padding: 8px 25px; border-radius: 20px; margin-top: 15px; cursor: pointer; font-size: 0.9rem;}

        /* === VIEW 2: äººç”Ÿæµå¹´ === */
        .sub-nav { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-bottom: 25px; }
        .sub-btn {
            background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1);
            color: #bbb; padding: 12px 0; border-radius: 10px; font-size: 0.9rem; cursor: pointer; text-align: center; transition: 0.3s;
        }
        .sub-btn.active { background: var(--primary); color: white; border-color: var(--accent); box-shadow: 0 0 15px rgba(123, 44, 191, 0.6); transform: translateY(-2px); font-weight: bold;}

        .timeline { padding-left: 10px; }
        .tl-item { position: relative; padding-left: 35px; margin-bottom: 35px; border-left: 2px solid var(--timeline-line); }
        .tl-item:last-child { border-left: 2px solid transparent; }
        .tl-dot { position: absolute; left: -9px; top: 0; width: 16px; height: 16px; border-radius: 50%; background: var(--bg); border: 3px solid var(--accent); box-shadow: 0 0 15px var(--accent); }
        .tl-time { font-size: 0.85rem; color: var(--accent); margin-bottom: 5px; font-weight: bold; letter-spacing: 1px; text-transform: uppercase; }
        .tl-title { font-size: 1.2rem; font-weight: bold; margin-bottom: 10px; color: #fff; }
        .tl-content { font-size: 1rem; line-height: 1.7; color: #d0d0d0; background: rgba(255,255,255,0.05); padding: 15px; border-radius: 12px; }
        .fade-in-text { animation: textFade 0.6s ease-in-out; }
        @keyframes textFade { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Loading */
        .loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(16, 0, 43, 0.98); display: none;
            justify-content: center; align-items: center; flex-direction: column; z-index: 999;
        }
        .spinner { width: 50px; height: 50px; border: 5px solid rgba(255,255,255,0.1); border-top-color: var(--accent); border-radius: 50%; animation: spin 1s infinite linear; margin-bottom: 20px;}
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div class="container">
        <div class="header">
            <span class="logo">ğŸ”®</span>
            <h1 class="title">ç´«å¾®åŸºå› è§£ç¢¼</h1>
            <div class="subtitle">ç´«å¾® â€§ å¡”ç¾… â€§ åŸºå› å…¨æ–¹ä½åˆ†æ</div>
        </div>

        <!-- è¼¸å…¥è¡¨å–® -->
        <div class="input-card" id="input-form">
            <div class="form-group">
                <label class="label">å§“å</label>
                <input type="text" id="username" placeholder="è«‹è¼¸å…¥æ‚¨çš„å§“å">
            </div>
            <div class="form-group">
                <label class="label">è¡€å‹ (åŸºå› ç‰¹è³ª)</label>
                <select id="blood">
                    <option value="A">A å‹</option>
                    <option value="B">B å‹</option>
                    <option value="O">O å‹</option>
                    <option value="AB">AB å‹</option>
                </select>
            </div>
            <div class="form-group">
                <label class="label">å‡ºç”Ÿæ—¥æœŸ</label>
                <input type="date" id="birthdate">
            </div>
            <div class="form-group">
                <label class="label">å‡ºç”Ÿæ™‚è¾°</label>
                <select id="birthtime">
                    <option value="23">å­æ™‚ (23-01)</option>
                    <option value="1">ä¸‘æ™‚ (01-03)</option>
                    <option value="3">å¯…æ™‚ (03-05)</option>
                    <option value="5">å¯æ™‚ (05-07)</option>
                    <option value="7">è¾°æ™‚ (07-09)</option>
                    <option value="9">å·³æ™‚ (09-11)</option>
                    <option value="11">åˆæ™‚ (11-13)</option>
                    <option value="13">æœªæ™‚ (13-15)</option>
                    <option value="15">ç”³æ™‚ (15-17)</option>
                    <option value="17">é…‰æ™‚ (17-19)</option>
                    <option value="19">æˆŒæ™‚ (19-21)</option>
                    <option value="21">äº¥æ™‚ (21-23)</option>
                </select>
            </div>
            <button class="btn-main" onclick="analyze()">å•Ÿå‹•å¤§æ•¸æ“šåˆ†æ</button>
        </div>

        <!-- çµæœé¡¯ç¤ºå€ -->
        <div id="result-section">
            
            <!-- èº«ä»½å¡ -->
            <div class="identity-card">
                <div class="star-icon">ğŸŒŸ</div>
                <div class="id-info">
                    <h2 id="user-star">ç´«å¾®æ˜Ÿ</h2>
                    <p id="user-desc">äº”è¡Œå±¬åœŸ â€§ å¸ç‹ä¹‹ç›¸</p>
                </div>
                <span class="blood-tag" id="user-blood">A å‹</span>
            </div>

            <!-- ä¸»é ç±¤ -->
            <div class="main-tabs">
                <div class="tab-btn active" onclick="switchMainTab('daily')">ğŸ“… ä»Šæ—¥é‹å‹¢</div>
                <div class="tab-btn" onclick="switchMainTab('life')">ğŸ”® äººç”Ÿæµå¹´</div>
            </div>

            <!-- VIEW 1: ä»Šæ—¥é‹å‹¢ -->
            <div id="view-daily" class="content-view active">
                <!-- ç´«å¾®é‹å‹¢ -->
                <div class="daily-box">
                    <span class="date-badge" id="today-date">2023/01/01</span>
                    <div class="lucky-row">
                        <div class="lucky-item">
                            <span class="lucky-val" id="d-color">é‡‘è‰²</span>
                            <span class="lucky-label">å¹¸é‹è‰²</span>
                        </div>
                        <div class="lucky-item">
                            <span class="lucky-val" id="d-num">8</span>
                            <span class="lucky-label">å¹¸é‹æ•¸</span>
                        </div>
                        <div class="lucky-item">
                            <span class="lucky-val" id="d-dir">åŒ—æ–¹</span>
                            <span class="lucky-label">å‰æ–¹ä½</span>
                        </div>
                    </div>
                    <div class="yi-ji-row">
                        <div class="yj-card yi"><strong>ğŸŸ¢ å®œ</strong><br><span id="d-yi">--</span></div>
                        <div class="yj-card ji"><strong>ğŸ”´ å¿Œ</strong><br><span id="d-ji">--</span></div>
                    </div>
                    <div class="daily-msg" id="d-advice">æ­£åœ¨è®€å–æ˜Ÿè±¡...</div>
                </div>

                <!-- å¡”ç¾…äº’å‹• -->
                <div class="tarot-section">
                    <div class="tarot-title">ğŸƒ æ¯æ—¥å¡”ç¾…æŒ‡å¼•</div>
                    <p style="font-size:0.85rem; color:#bbb; margin-bottom:20px;">å†¥æƒ³ä»Šæ—¥çš„è¡Œç¨‹ï¼Œé»æ“Šå¡èƒŒç¿»ç‰Œ</p>
                    <div class="card-scene" onclick="flipTarot()">
                        <div class="card-obj" id="tarot-obj">
                            <div class="card-face card-back"></div>
                            <div class="card-face card-front">
                                <div class="tarot-img" id="tarot-img">ğŸ©</div>
                                <div class="tarot-name" id="tarot-name">é­”è¡“å¸«</div>
                                <div class="tarot-key" id="tarot-key">å‰µé€ åŠ›</div>
                            </div>
                        </div>
                    </div>
                    <div class="tarot-desc-box" id="tarot-desc-box">
                        <strong style="color:#ffd700; display:block; margin-bottom:8px; font-size:1.1rem;">ğŸ”® ç‰Œç¾©è§£æï¼š</strong>
                        <span id="tarot-desc" style="color:#eee; line-height:1.5;"></span>
                        <div style="text-align:center;">
                            <button class="tarot-btn" onclick="resetTarot(event)">â†º é‡æ–°æ´—ç‰Œ</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 2: äººç”Ÿæµå¹´ -->
            <div id="view-life" class="content-view">
                <div class="sub-nav">
                    <div class="sub-btn active" onclick="switchLifeSubTab('career')">ğŸ’¼ äº‹æ¥­</div>
                    <div class="sub-btn" onclick="switchLifeSubTab('love')">â¤ï¸ æ„Ÿæƒ…</div>
                    <div class="sub-btn" onclick="switchLifeSubTab('family')">ğŸ  å®¶åº­</div>
                    <div class="sub-btn" onclick="switchLifeSubTab('health')">ğŸ’ª å¥åº·</div>
                </div>
                <div class="timeline">
                    <div class="tl-item">
                        <div class="tl-dot"></div>
                        <div class="tl-time">PAST â€§ å…ˆå¤©åŸºå› </div>
                        <div class="tl-title">æ—©å¹´é‹ç¨‹</div>
                        <div class="tl-content" id="tl-past">åˆ†æä¸­...</div>
                    </div>
                    <div class="tl-item">
                        <div class="tl-dot"></div>
                        <div class="tl-time">PRESENT â€§ ç•¶ä¸‹æ©Ÿé‡</div>
                        <div class="tl-title">è¿‘æœŸç™¼å±•</div>
                        <div class="tl-content" id="tl-present">åˆ†æä¸­...</div>
                    </div>
                    <div class="tl-item">
                        <div class="tl-dot"></div>
                        <div class="tl-time">FUTURE â€§ å‘½é‹å±•æœ›</div>
                        <div class="tl-title">æœªä¾†èµ°å‘</div>
                        <div class="tl-content" id="tl-future">åˆ†æä¸­...</div>
                    </div>
                </div>
            </div>

            <button onclick="location.reload()" style="width:100%; padding:15px; background:transparent; border:1px solid #666; color:#aaa; border-radius:12px; margin-top:30px; font-size:1rem;">â†º é‡æ–°è¼¸å…¥è³‡æ–™</button>
        </div>
    </div>

    <div class="loader" id="loader">
        <div class="spinner"></div>
        <p style="color:white; margin-top:15px; font-weight:bold; letter-spacing:1px;">æ˜Ÿè±¡å¤§æ•¸æ“šé‹ç®—ä¸­...</p>
    </div>

    <script>
        // --- è³‡æ–™åº« ---
        const starTraits = {
            "ç´«å¾®æ˜Ÿ": { type: "åœŸ", career: "é ˜å°çµ±å¾¡/å‰µæ¥­ç®¡ç†/é«˜å±¤æ±ºç­–", love: "çœ¼å…‰é«˜/ä¸»å°æ¬Šå¼·/é‡è¦–å°Šåš´", family: "ä¸€å®¶ä¹‹ä¸»/è²¬ä»»é‡å¤§/å­å¥³å„ªç§€", health: "è„¾èƒƒ/ç²¾ç¥å£“åŠ›/é ­ç—›" },
            "å¤©æ©Ÿæ˜Ÿ": { type: "æœ¨", career: "ä¼åŠƒåˆ†æ/ç‰¹åŠ©å¹•åƒš/ç§‘æŠ€ç ”ç™¼", love: "å¿ƒæ€ç´°è†©/å®¹æ˜“å¤šç–‘/ç²¾ç¥å¥‘åˆ", family: "å…„å¼Ÿç·£ä½³/è®Šå‹•è¼ƒå¤š/éœ€å¤šæºé€š", health: "ç¥ç¶“ç³»çµ±/å››è‚¢/ç¡çœ " },
            "å¤ªé™½æ˜Ÿ": { type: "ç«", career: "å…¬çœ¾äº‹å‹™/å¤–äº¤å…¬é—œ/ç†±å¿ƒåŠ©äºº", love: "ç†±æƒ…ç›´æ¥/ä»˜å‡ºè¼ƒå¤š/å› æ„›è€Œç´¯", family: "çˆ¶æ…ˆå­å­/ç‚ºå®¶å¥”æ³¢/å…‰è€€é–€æ¥£", health: "å¿ƒè¡€ç®¡/çœ¼éƒ¨/è¡€å£“" },
            "æ­¦æ›²æ˜Ÿ": { type: "é‡‘", career: "é‡‘èæŠ•è³‡/è»è­¦æª¢æ³•/å¯¦æ¥­å®¶", love: "å‰›æ¯…æœ¨è¨¥/å¯¦éš›è¡Œå‹•/å°‘é»æµªæ¼«", family: "ç®¡æ•™åš´æ ¼/è²¡æ¬Šåœ¨æ¡/ç•¥é¡¯åš´è‚…", health: "å‘¼å¸ç³»çµ±/ç‰™é½’/éª¨éª¼" },
            "å¤©åŒæ˜Ÿ": { type: "æ°´", career: "é¤é£²æ—…éŠ/ä¼‘é–’ç”¢æ¥­/è¡Œæ”¿åº¶å‹™", love: "æº«æŸ”è¢«å‹•/å®¹æ˜“æ„Ÿå‹•/äº«å—è¢«æ„›", family: "ç›¸è™•èæ´½/æ°£æ°›å’Œè«§/æœ‰ç¦æ°£", health: "è…è‡Ÿ/è†€èƒ±/æ°´è…«" },
            "å»‰è²æ˜Ÿ": { type: "ç«", career: "å¤–äº¤å…¬é—œ/è—è¡“è¨­è¨ˆ/ç²¾å¯†ä½œæ¥­", love: "æ„›æ¨åˆ†æ˜/ä½”æœ‰æ¬²å¼·/æ¡ƒèŠ±æ—ºç››", family: "è¦ªæƒ…æ¿ƒåš/æƒ…ç·’èµ·ä¼/éœ€å¤šåŒ…å®¹", health: "å¿ƒç«æ—º/å¤±çœ /è¡€æ¶²å¾ªç’°" },
            "å¤©åºœæ˜Ÿ": { type: "åœŸ", career: "åº«æˆ¿ç®¡ç†/åœ°ç”¢ç¶“ç‡Ÿ/ç©©å®šä¿å®ˆ", love: "é‡è¦–æ¢ä»¶/ç©©é‡å‹™å¯¦/ç´°æ°´é•·æµ", family: "è³¼ç½®ç”°ç”¢/å®¶åº­å¯Œè¶³/é•·è¼©ç·£ä½³", health: "è„¾èƒƒ/æ¶ˆåŒ–ç³»çµ±/é«”é‡" },
            "å¤ªé™°æ˜Ÿ": { type: "æ°´", career: "è²¡å‹™æœƒè¨ˆ/è­·ç†ç…§è­·/æˆ¿ç”¢æŠ•è³‡", love: "æº«æŸ”å©‰ç´„/æƒ…æ„Ÿè±å¯Œ/è¿½æ±‚æµªæ¼«", family: "é‡è¦–æ•´æ½”/æ¯æ€§å…‰è¼/å±…å®¶ç”Ÿæ´»", health: "å©¦ç§‘/å…§åˆ†æ³Œ/æ³Œå°¿ç³»çµ±" },
            "è²ªç‹¼æ˜Ÿ": { type: "æ°´", career: "æ¼”è—å¨›æ¨‚/æ¥­å‹™è¡ŒéŠ·/æ•™è‚²è¨“ç·´", love: "é•·è¢–å–„èˆ/å¤šé‡‡å¤šå§¿/ç•°æ€§ç·£ä½³", family: "ç¤¾äº¤é »ç¹/é–‹æ”¾é–‹æ˜/ä¸å–œç´„æŸ", health: "è‚è†½/æ’æ¯’åŠŸèƒ½/é—œç¯€" },
            "å·¨é–€æ˜Ÿ": { type: "æ°´", career: "å¾‹å¸«æ³•å‹™/æ•™å¸«è¬›å¸«/è©•è«–åˆ†æ", love: "æºé€šéšœç¤™/æ˜“ç”Ÿå£è§’/éœ€å¤šä¿¡ä»»", family: "æ„è¦‹è¼ƒå¤š/éš”é–¡èª¤æœƒ/éœ€å¤šå‚¾è½", health: "å‘¼å¸é“/è…¸èƒƒ/å£è…”" },
            "å¤©ç›¸æ˜Ÿ": { type: "æ°´", career: "ç§˜æ›¸ç‰¹åŠ©/æœå‹™è«®è©¢/å½¢è±¡ç®¡ç†", love: "å¤–è²Œå”æœƒ/é«”è²¼å…¥å¾®/å¤«å”±å©¦éš¨", family: "å’Œæ¨‚èè/äº’ç›¸æ‰¶æŒ/è¡£é£Ÿç„¡æ†‚", health: "çš®è†š/éæ•/è…è‡Ÿ" },
            "å¤©æ¢æ˜Ÿ": { type: "åœŸ", career: "é†«ç™‚æœå‹™/å…¬å‹™äººå“¡/é¡§å•æŒ‡å°", love: "è€å¤«å°‘å¦»/ç…§é¡§å°æ–¹/æˆç†Ÿç©©é‡", family: "é•·å¹¼æœ‰åº/è”­åº‡å­å­«/å‚³çµ±ä¿å®ˆ", health: "è„¾èƒƒ/æ…¢æ€§ç—…/è„Šæ¤" },
            "ä¸ƒæ®ºæ˜Ÿ": { type: "é‡‘", career: "æ¥­å‹™é–‹ç™¼/å·¥ç¨‹å»ºè¨­/ç¨ç«‹å‰µæ¥­", love: "æ•¢æ„›æ•¢æ¨/é–ƒå©šé–ƒé›¢/å€‹æ€§å‰›çƒˆ", family: "èšå°‘é›¢å¤š/ç¨ç«‹è‡ªä¸»/è¼ƒå°‘ä¾è³´", health: "å¤–å‚·/è‚ºéƒ¨/å¤§è…¸" },
            "ç ´è»æ˜Ÿ": { type: "æ°´", career: "å‰µæ„è¨­è¨ˆ/è²¿æ˜“é‹è¼¸/ç ´èˆŠç«‹æ–°", love: "å–œæ–°å­èˆŠ/ä¸å–œæŸç¸›/è½Ÿè½Ÿçƒˆçƒˆ", family: "è®Šå‹•æ¬é·/è§€å¿µæ–°æ½®/ä»£æºè¼ƒæ·±", health: "ç”Ÿæ®–ç³»çµ±/è…è‡Ÿ/å¿ƒè‡Ÿ" }
        };

        const tarotDeck = [
            { name: "æ„šè€…", icon: "ğŸ¤¡", key: "æ–°é–‹å§‹", desc: "å¤§è†½é‚å‡ºç¬¬ä¸€æ­¥ï¼Œä¸è¦ç•æ‡¼æœªçŸ¥çš„æŒ‘æˆ°ï¼Œä¿æŒç´”çœŸçš„å¿ƒã€‚" },
            { name: "é­”è¡“å¸«", icon: "ğŸ©", key: "å‰µé€ åŠ›", desc: "ä½ æ“æœ‰å¯¦ç¾ç›®æ¨™æ‰€éœ€çš„ä¸€åˆ‡è³‡æºï¼Œç™¼æ®ä½ çš„æ‰èƒ½å§ã€‚" },
            { name: "å¥³ç¥­å¸", icon: "ğŸ“œ", key: "ç›´è¦º", desc: "éœä¸‹å¿ƒä¾†å‚¾è½å…§å¿ƒçš„è²éŸ³ï¼Œç­”æ¡ˆå°±åœ¨ä½ çš„æ½›æ„è­˜è£¡ã€‚" },
            { name: "å¥³çš‡", icon: "ğŸ‘¸", key: "è±ç››", desc: "äº«å—ç”Ÿæ´»ä¸­çš„ç¾å¥½èˆ‡å¯Œè¶³ï¼Œé€™æ˜¯ä¸€å€‹å……æ»¿å‰µé€ åŠ›èˆ‡æ„›çš„æ—¥å­ã€‚" },
            { name: "çš‡å¸", icon: "ğŸ‘‘", key: "æ¬Šå¨", desc: "å±•ç¾ä½ çš„é ˜å°åŠ›èˆ‡è‡ªå¾‹ï¼Œå»ºç«‹ç©©å›ºçš„åŸºç¤èˆ‡ç§©åºã€‚" },
            { name: "æ•™çš‡", icon: "â›ª", key: "æŒ‡å¼•", desc: "å°‹æ±‚å‚³çµ±çš„æ™ºæ…§æˆ–é•·è¼©çš„å»ºè­°ï¼Œé€™èƒ½å¹«åŠ©ä½ è§£æ±ºå›°æƒ‘ã€‚" },
            { name: "æˆ€äºº", icon: "ğŸ’•", key: "é¸æ“‡", desc: "é¢è‡¨é‡è¦çš„æ±ºå®šï¼Œè«‹è¿½éš¨ä½ çš„å¿ƒï¼Œé‡è¦–äººéš›èˆ‡æƒ…æ„Ÿçš„äº¤æµã€‚" },
            { name: "æˆ°è»Š", icon: "ğŸ›’", key: "æ„å¿—åŠ›", desc: "åªè¦å …æŒåˆ°åº•ï¼Œå…‹æœçœ¼å‰çš„éšœç¤™ï¼Œå‹åˆ©çµ‚å°‡å±¬æ–¼ä½ ã€‚" },
            { name: "åŠ›é‡", icon: "ğŸ¦", key: "å‹‡æ°£", desc: "ä»¥æŸ”å…‹å‰›ï¼Œç”¨å…§åœ¨çš„å …å®šèˆ‡è€å¿ƒä¾†åŒ–è§£å¤–åœ¨çš„è¡çªã€‚" },
            { name: "éš±å£«", icon: "ğŸ®", key: "åæ€", desc: "æš«æ™‚ç¨è™•ä¸€ä¸‹ï¼Œå‘å…§å°‹æ‰¾æ™ºæ…§ï¼Œç¾åœ¨ä¸æ˜¯è¡Œå‹•çš„æœ€ä½³æ™‚æ©Ÿã€‚" },
            { name: "å‘½é‹ä¹‹è¼ª", icon: "ğŸ¡", key: "æ”¹è®Š", desc: "é †å‹¢è€Œç‚ºï¼Œå¹¸é‹å¥³ç¥æ­£åœ¨å‘ä½ å¾®ç¬‘ï¼ŒæŠŠæ¡è½‰æ©Ÿã€‚" },
            { name: "æ­£ç¾©", icon: "âš–ï¸", key: "å¹³è¡¡", desc: "èª å¯¦é¢å°è‡ªå·±ï¼Œåšå‡ºå…¬æ­£çš„åˆ¤æ–·ï¼Œå› æœå¾ªç’°è‡ªæœ‰å®šæ•¸ã€‚" },
            { name: "æ­»ç¥", icon: "ğŸ’€", key: "é‡ç”Ÿ", desc: "çµæŸæ˜¯æ–°çš„é–‹å§‹ï¼Œæ”¾ä¸‹éå»ä¸å†é©åˆä½ çš„äººäº‹ç‰©ã€‚" },
            { name: "ç¯€åˆ¶", icon: "ğŸº", key: "èª¿å’Œ", desc: "ä¿æŒä¸­åº¸ä¹‹é“ï¼Œå°‹æ±‚åˆä½œèˆ‡å¹³è¡¡ï¼Œä¸è¦éåº¦æ¥µç«¯ã€‚" },
            { name: "æ˜Ÿæ˜Ÿ", icon: "ğŸŒŸ", key: "å¸Œæœ›", desc: "ä¿æŒæ¨‚è§€èˆ‡ä¿¡å¿µï¼Œä½ çš„é¡˜æœ›æ­£åœ¨æ…¢æ…¢å¯¦ç¾ä¸­ã€‚" },
            { name: "æœˆäº®", icon: "ğŸŒ™", key: "ä¸å®‰", desc: "çœ¼å‰å¯èƒ½æœ‰äº›è¿·éœ§ï¼Œä¸è¦è¢«ææ‡¼è’™è”½ï¼Œç›¸ä¿¡ä½ çš„ç›´è¦ºã€‚" },
            { name: "å¤ªé™½", icon: "â˜€ï¸", key: "æˆåŠŸ", desc: "å……æ»¿æ´»åŠ›èˆ‡å–œæ‚…çš„ä¸€å¤©ï¼Œæ‰€æœ‰çš„é™°éœ¾éƒ½å°‡ä¸€æƒè€Œç©ºã€‚" },
            { name: "ä¸–ç•Œ", icon: "ğŸŒ", key: "åœ“æ»¿", desc: "ä¸€å€‹éšæ®µçš„å®Œç¾çµæŸï¼Œäº«å—ä½ çš„æˆå°±ï¼Œæº–å‚™è¿æ¥æ–°æ—…ç¨‹ã€‚" }
        ];

        const textTemplates = {
            career: { past: "æ—©å¹´å³å±•ç¾ã€{Trait}ã€‘çš„æ½›è³ªï¼Œæ±‚å­¸éšæ®µé›–æœ‰æ³¢æŠ˜ï¼Œä½†åŸºç¤æ‰“å¾—ç›¸ç•¶ç´®å¯¦ã€‚", present: "ç›®å‰æ­£è™•æ–¼äº‹æ¥­çš„é—œéµæœŸï¼Œã€{Trait}ã€‘çš„ç‰¹è³ªè®“ä½ èƒ½åœ¨è·å ´ä¸Šç¨ç•¶ä¸€é¢ã€‚", future: "æœªä¾†çš„æ ¼å±€å°‡æ›´åŠ å®å¤§ï¼Œé©åˆå¾€ã€{Trait}ã€‘ç›¸é—œé ˜åŸŸæ·±è€•ï¼Œæ™šå¹´å°‡äº«æœ‰æ¥µé«˜çš„è²æœ›ã€‚" },
            love: { past: "éå»åœ¨æ„Ÿæƒ…ä¸Šè¼ƒç‚ºã€{Trait}ã€‘ï¼Œç¶“æ­·éå¹¾æ®µæ·±åˆ»çš„ç·£åˆ†ï¼Œè®“ä½ æ›´æ‡‚è‡ªå·±ã€‚", present: "è¿‘æœŸçš„æ¡ƒèŠ±é‹å‹¢èˆ‡ã€{Trait}ã€‘æœ‰é—œï¼Œå»ºè­°å¤šåƒèˆ‡ç¤¾äº¤æ´»å‹•ï¼Œè‹¥æœ‰ä¼´ä¾¶éœ€å¤šæºé€šã€‚", future: "æœªä¾†çš„æ„Ÿæƒ…ç”Ÿæ´»å°‡è¶¨æ–¼ç©©å®šï¼Œã€{Trait}ã€‘çš„ç‰¹è³ªå°‡è½‰åŒ–ç‚ºå°ä¼´ä¾¶çš„æ·±æƒ…èˆ‡è²¬ä»»ã€‚" },
            family: { past: "åŸç”Ÿå®¶åº­çµ¦äºˆä½ çš„å½±éŸ¿æ·±é ï¼Œã€{Trait}ã€‘çš„æ°›åœé€ å°±äº†ä½ ç¾åœ¨çš„æ€§æ ¼ã€‚", present: "ç›®å‰å®¶åº­æ˜¯ä½ æ‰“æ‹¼çš„å¾Œç›¾ï¼Œé›–ç„¶å¶æœ‰ã€{Trait}ã€‘çš„æƒ…æ³ï¼Œä½†æ•´é«”é‹å‹¢æ˜¯å‘ä¸Šçš„ã€‚", future: "æ™šå¹´å°‡äº«æœ‰å¤©å€«ä¹‹æ¨‚ï¼Œã€{Trait}ã€‘çš„å®¶åº­è§€å¿µå°‡å‚³æ‰¿çµ¦ä¸‹ä¸€ä»£ï¼Œå®¶é‹æ˜Œéš†ã€‚" },
            health: { past: "å¹¼å¹´é«”è³ªå°šå¯ï¼Œä½†éœ€æ³¨æ„ã€{Trait}ã€‘ç›¸é—œçš„å°æ¯›ç—…ï¼Œéå»å¯èƒ½å¿½ç•¥äº†è­¦è¨Šã€‚", present: "è¿‘æœŸå·¥ä½œå£“åŠ›è¼ƒå¤§ï¼Œå®¹æ˜“å¼•ç™¼ã€{Trait}ã€‘çš„ä¸é©ã€‚å»ºè­°èª¿æ•´ä½œæ¯ï¼Œå¤šæ”å–å¤©ç„¶é£Ÿç‰©ã€‚", future: "éš¨è‘—å¹´é½¡å¢é•·ï¼Œéœ€ç‰¹åˆ¥ä¿é¤Šã€{Trait}ã€‘éƒ¨ä½ã€‚è‹¥èƒ½ä¿æŒè¦å¾‹é‹å‹•ï¼Œæ™šå¹´èº«é«”å°‡ç¡¬æœ—ã€‚" }
        };

        const dailyConfig = {
            colors: ["çš‡å®¶é‡‘", "æ·±æµ·è—", "é…’ç´…è‰²", "æ£®æ—ç¶ ", "çç ç™½", "æ›œçŸ³é»‘", "è–°è¡£è‰ç´«"],
            directions: ["åŒ—æ–¹", "å—æ–¹", "æ±æ–¹", "è¥¿æ–¹", "æ±åŒ—", "è¥¿åŒ—", "æ±å—", "è¥¿å—"],
            actionsYi: ["ç°½ç´„", "å‘Šç™½", "å‰ªé«®", "é‹å‹•", "å†¥æƒ³", "é–±è®€", "èšé¤", "æŠ•è³‡", "å¤§æƒé™¤"],
            actionsJi: ["çˆ­åµ", "ä½œä¿", "ç†¬å¤œ", "å…«å¦", "æš´é£Ÿ", "å€ŸéŒ¢", "é è¡Œ", "æ€¥èº"]
        };

        let currentStar = "ç´«å¾®æ˜Ÿ";
        let currentBlood = "A";
        let currentLifeTab = "career";
        let isFlipped = false;

        function analyze() {
            const name = document.getElementById('username').value;
            const date = document.getElementById('birthdate').value;
            const time = parseInt(document.getElementById('birthtime').value);
            const blood = document.getElementById('blood').value;

            if (!date) { alert("è«‹è¼¸å…¥å‡ºç”Ÿæ—¥æœŸ"); return; }

            document.getElementById('input-form').style.display = 'none';
            document.getElementById('loader').style.display = 'flex';

            setTimeout(() => {
                calculate(name, date, time, blood);
                document.getElementById('loader').style.display = 'none';
                document.getElementById('result-section').style.display = 'block';
            }, 1500);
        }

        function calculate(name, dateStr, time, blood) {
            const d = new Date(dateStr);
            const seed = d.getFullYear() + d.getMonth() + d.getDate() + time + blood.length;
            const starKeys = Object.keys(starTraits);
            currentStar = starKeys[seed % starKeys.length];
            currentBlood = blood;
            const starInfo = starTraits[currentStar];

            document.getElementById('user-star').innerText = currentStar;
            document.getElementById('user-desc').innerText = `äº”è¡Œå±¬${starInfo.type} â€§ ${blood}å‹ç‰¹è³ª`;
            document.getElementById('user-blood').innerText = blood + "å‹";

            updateDailyView(starInfo, seed);
            updateLifeTimeline("career");
        }

        function updateDailyView(starInfo, seed) {
            const today = new Date();
            const todaySeed = today.getDate() + today.getMonth() + seed;
            
            document.getElementById('today-date').innerText = `${today.getFullYear()}/${today.getMonth()+1}/${today.getDate()}`;
            document.getElementById('d-color').innerText = dailyConfig.colors[todaySeed % 7];
            document.getElementById('d-num').innerText = (todaySeed % 9) + 1;
            document.getElementById('d-dir').innerText = dailyConfig.directions[todaySeed % 8];
            document.getElementById('d-yi').innerText = `${dailyConfig.actionsYi[todaySeed % 9]}ã€${dailyConfig.actionsYi[(todaySeed+1)%9]}`;
            document.getElementById('d-ji').innerText = `${dailyConfig.actionsJi[todaySeed % 8]}ã€${dailyConfig.actionsJi[(todaySeed+2)%8]}`;
            
            const tips = ["ä½èª¿è¡Œäº‹ï¼Œé¿å…é‹’èŠ’å¤ªéœ²", "è²´äººé‹æ—ºï¼Œé©åˆæ±‚åŠ©é•·è¼©", "è²¡é‹ä¸éŒ¯ï¼Œä½†æ³¨æ„è¡å‹•æ¶ˆè²»", "æƒ…ç·’æ˜“æ³¢å‹•ï¼Œå»ºè­°ä¿æŒå†·éœ", "æ¡ƒèŠ±æœµæœµé–‹ï¼Œç•™æ„èº«é‚Šç•°æ€§"];
            document.getElementById('d-advice').innerHTML = `ğŸ’¡ <b>ç´«å¾®æŒ‡å¼•ï¼š</b>${tips[todaySeed % 5]}ã€‚<br>å—${currentBlood}å‹è¡€å½±éŸ¿ï¼Œä»Šæ—¥è¡Œäº‹é¢¨æ ¼å®œ${currentBlood==='B'||currentBlood==='AB'?'ä¿æŒå½ˆæ€§':'ç©©ç´®ç©©æ‰“'}ã€‚`;
        }

        function flipTarot() {
            if(isFlipped) return;
            isFlipped = true;
            const cardObj = document.getElementById('tarot-obj');
            cardObj.classList.add('is-flipped');
            
            const randIndex = Math.floor(Math.random() * tarotDeck.length);
            const card = tarotDeck[randIndex];

            setTimeout(() => {
                document.getElementById('tarot-img').innerText = card.icon;
                document.getElementById('tarot-name').innerText = card.name;
                document.getElementById('tarot-key').innerText = card.key;
                document.getElementById('tarot-desc').innerText = card.desc;
                document.getElementById('tarot-desc-box').style.display = 'block';
            }, 300);
        }

        function resetTarot(e) {
            e.stopPropagation();
            const cardObj = document.getElementById('tarot-obj');
            cardObj.classList.remove('is-flipped');
            document.getElementById('tarot-desc-box').style.display = 'none';
            isFlipped = false;
        }

        function updateLifeTimeline(category) {
            currentLifeTab = category;
            const starInfo = starTraits[currentStar];
            const keywords = starInfo[category].split('/'); 
            const tpl = textTemplates[category];
            
            const pastText = tpl.past.replace(/{Trait}/g, keywords[0]);
            const presentText = tpl.present.replace(/{Trait}/g, keywords[1] || keywords[0]);
            const futureText = tpl.future.replace(/{Trait}/g, keywords[2] || keywords[0]);

            const doms = [document.getElementById('tl-past'), document.getElementById('tl-present'), document.getElementById('tl-future')];
            doms.forEach(el => { el.classList.remove('fade-in-text'); void el.offsetWidth; el.classList.add('fade-in-text'); });

            document.getElementById('tl-past').innerHTML = pastText;
            document.getElementById('tl-present').innerHTML = presentText;
            document.getElementById('tl-future').innerHTML = futureText;
        }

        function switchMainTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.content-view').forEach(v => v.classList.remove('active'));
            if(tab === 'daily') {
                document.querySelector('.tab-btn:nth-child(1)').classList.add('active');
                document.getElementById('view-daily').classList.add('active');
            } else {
                document.querySelector('.tab-btn:nth-child(2)').classList.add('active');
                document.getElementById('view-life').classList.add('active');
                updateLifeTimeline(currentLifeTab);
            }
        }

        function switchLifeSubTab(category) {
            const buttons = document.querySelectorAll('.sub-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            const map = { 'career': 0, 'love': 1, 'family': 2, 'health': 3 };
            buttons[map[category]].classList.add('active');
            updateLifeTimeline(category);
        }

        document.getElementById('birthdate').max = new Date().toISOString().split("T")[0];
    </script>
</body>
</html>